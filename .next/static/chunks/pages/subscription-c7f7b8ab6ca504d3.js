(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[535],{7338:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/subscription",function(){return r(7940)}])},7940:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return u}});var t=r(5893),i=r(7294),n=r(1163),l=r(4465);r(9724),r(8232);let o={FREE:"free",PREMIUM:"premium"},a={[o.FREE]:{recipesPerDay:2,dietFilters:1,mealPlanDays:3,pantryItems:20,savedRecipes:10},[o.PREMIUM]:{recipesPerDay:1/0,dietFilters:1/0,mealPlanDays:30,pantryItems:1/0,savedRecipes:1/0}},c=(0,i.createContext)(),d={PREMIUM:{name:"Premium",price:9,displayPrice:"$9",period:"/month"}};r(7490),r(3774);let m=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]},x=e=>{m("subscription_page_view",{current_plan:e})},p=()=>{m("portal_access")},h=(e,s,r)=>{m("subscription_success",{plan_name:e,price:s,user_id:r})};function u(e){let{user:s}=e,r=(0,n.useRouter)(),l=function(){let e=(0,i.useContext)(c);if(!e)throw Error("useSubscription must be used within SubscriptionProvider");return e}(),[m,u]=(0,i.useState)(!1),[j,f]=(0,i.useState)(null),{success:g,session_id:y}=r.query;if((0,i.useEffect)(()=>{s?(x(l.planTier),g&&h(d.PREMIUM.name,d.PREMIUM.price.toString(),s.uid)):r.push("/")},[s,r,g,l.planTier]),!s)return null;let b=async()=>{u(!0),f(null),p();try{let e=await fetch("/api/stripe/portal",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:l.stripeCustomerId})}),s=await e.json();if(s.url)window.location.href=s.url;else throw Error("Failed to create portal session")}catch(e){console.error("Error:",e),f("Failed to open subscription management portal")}finally{u(!1)}},N=()=>{r.push("/upgrade")},k=l.isPremium,v=k?o.PREMIUM:o.FREE,w=a[v];return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("nav",{className:"bg-white shadow-sm mb-8",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,t.jsx)("button",{onClick:()=>r.push("/"),className:"text-2xl font-bold text-primary",children:"ChefWise"}),(0,t.jsx)("button",{onClick:()=>r.push("/profile"),className:"text-gray-700 hover:text-primary",children:"‚Üê Back to Profile"})]})})}),(0,t.jsxs)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[g&&(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("svg",{className:"w-6 h-6 text-green-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-green-800 font-semibold",children:"Subscription Updated Successfully!"}),(0,t.jsx)("p",{className:"text-green-700 text-sm mt-1",children:"Welcome to ChefWise Premium! You now have access to all premium features."})]})]})}),j&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,t.jsx)("p",{className:"text-red-800",children:j})}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Your Subscription"}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-xl font-semibold capitalize",children:[v," Plan"]}),(0,t.jsxs)("p",{className:"text-gray-600 mt-1",children:["Status: ",(0,t.jsx)("span",{className:"capitalize font-medium",children:l.status})]}),l.subscriptionPeriodEnd&&(0,t.jsxs)("p",{className:"text-gray-600 text-sm mt-1",children:["Renews on: ",l.subscriptionPeriodEnd.toLocaleDateString()]})]}),k?(0,t.jsx)("span",{className:"bg-gradient-to-r from-primary to-secondary text-white px-6 py-3 rounded-lg font-semibold",children:"Premium Active"}):(0,t.jsx)("button",{onClick:N,className:"bg-primary text-white px-6 py-3 rounded-lg font-semibold hover:bg-primary/90 transition-colors",children:"Upgrade to Premium"})]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h4",{className:"font-semibold mb-3",children:"Your Plan Includes:"}),(0,t.jsxs)("ul",{className:"space-y-2",children:[(0,t.jsxs)("li",{className:"flex items-center text-gray-700",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-primary mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),w.recipesPerDay===1/0?"Unlimited AI recipe generation":"".concat(w.recipesPerDay," AI recipes per day")]}),(0,t.jsxs)("li",{className:"flex items-center text-gray-700",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-primary mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),w.dietFilters===1/0?"All diet filters":"".concat(w.dietFilters," diet filter")]}),(0,t.jsxs)("li",{className:"flex items-center text-gray-700",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-primary mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Up to ",w.mealPlanDays,"-day meal planning"]}),(0,t.jsxs)("li",{className:"flex items-center text-gray-700",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-primary mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),w.pantryItems===1/0?"Unlimited pantry items":"Up to ".concat(w.pantryItems," pantry items")]}),(0,t.jsxs)("li",{className:"flex items-center text-gray-700",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-primary mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),w.savedRecipes===1/0?"Unlimited saved recipes":"Up to ".concat(w.savedRecipes," saved recipes")]}),k&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("li",{className:"flex items-center text-gray-700",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-primary mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Shopping list export"]}),(0,t.jsxs)("li",{className:"flex items-center text-gray-700",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-primary mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Priority support"]})]})]})]}),k&&l.stripeCustomerId&&(0,t.jsxs)("div",{className:"border-t mt-6 pt-6",children:[(0,t.jsx)("button",{onClick:b,disabled:m,className:"w-full bg-gray-100 text-gray-900 px-6 py-3 rounded-lg font-semibold hover:bg-gray-200 transition-colors disabled:opacity-50",children:m?"Loading...":"Manage Subscription & Billing"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2 text-center",children:"Update payment method, view invoices, or cancel subscription"})]})]}),!k&&(0,t.jsxs)("div",{className:"bg-gradient-to-r from-primary to-secondary rounded-lg shadow-md p-8 text-white",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold mb-4",children:"Unlock Premium Features"}),(0,t.jsx)("p",{className:"mb-6 text-white/90",children:"Get unlimited access to all ChefWise features for just $9/month"}),(0,t.jsxs)("ul",{className:"space-y-3 mb-6",children:[(0,t.jsxs)("li",{className:"flex items-center",children:[(0,t.jsx)("svg",{className:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Unlimited AI-generated recipes"]}),(0,t.jsxs)("li",{className:"flex items-center",children:[(0,t.jsx)("svg",{className:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Advanced 30-day meal planning"]}),(0,t.jsxs)("li",{className:"flex items-center",children:[(0,t.jsx)("svg",{className:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"All diet filters and preferences"]}),(0,t.jsxs)("li",{className:"flex items-center",children:[(0,t.jsx)("svg",{className:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Priority customer support"]})]}),(0,t.jsx)("button",{onClick:N,className:"bg-white text-primary px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Upgrade Now"})]})]})]})}(0,l.J)("")}},function(e){e.O(0,[942,888,774,179],function(){return e(e.s=7338)}),_N_E=e.O()}]);